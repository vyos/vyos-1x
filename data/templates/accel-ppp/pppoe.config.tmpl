### generated by accel_pppoe.py ###
[modules]
log_syslog
pppoe
{% if auth_mode == 'radius' %}
radius
{% endif %}
chap-secrets
ippool
{% if ppp_ipv6 != 'deny' %}
ipv6pool
ipv6_nd
ipv6_dhcp
{% endif %}
{% for proto in auth_proto: %}
{{proto}}
{% endfor%}
shaper
{% if snmp %}
net-snmp
{% endif %}
{% if limits %}
connlimit
{% endif %}

[core]
thread-count={{ thread_cnt }}

[log]
syslog=accel-pppoe,daemon
copy=1
level=5

{% if snmp == 'enable-ma' %}
[snmp]
master=1
{% endif %}

[client-ip-range]
disable

{% if ppp_gw %}
[ip-pool]
gw-ip-address={{ ppp_gw }}
{% if client_ip_pool %}
{{ client_ip_pool }}
{% endif -%}
{% if client_ip_subnets %}
{% for subnet in client_ip_subnets %}
{{ subnet }}
{% endfor %}
{% endif %}
{% endif %}

{% if client_ipv6_pool %}
[ipv6-nd]
AdvAutonomousFlag=1

[ipv6-pool]
{% for p in client_ipv6_pool %}
{{ p.prefix }},{{ p.mask }}
{% endfor %}
{% for p in client_ipv6_delegate_prefix %}
delegate={{ p.prefix }},{{ p.mask }}
{% endfor %}
{% endif %}

{% if dnsv4 %}
[dns]
{% for dns in dnsv4 -%}
dns{{ loop.index }}={{ dns }}
{% endfor -%}
{% endif %}

{% if dnsv6 %}
[ipv6-dns]
{% for dns in dnsv6 -%}
{{ dns }}
{% endfor -%}
{% endif %}

{% if wins %}
[wins]
{% for server in wins -%}
wins{{ loop.index }}={{ server }}
{% endfor -%}
{% endif %}

{% if auth_mode == 'local' %}
[chap-secrets]
chap-secrets={{ chap_secrets_file }}
{% elif auth_mode == 'radius' %}
[radius]
verbose=1
{% for r in radius_server %}
server={{ r.server }},{{ r.key }},auth-port={{ r.port }},acct-port={{ r.acct_port }},req-limit=0,fail-time={{ r.fail_time }}
{% endfor -%}

{% if radius_acct_inter_jitter %}
acct-interim-jitter={{ radius_acct_inter_jitter }}
{% endif %}

acct-timeout={{ radius_acct_tmo }}
timeout={{ radius_timeout }}
max-try={{ radius_max_try }}

{% if radius_nas_id %}
nas-identifier={{ radius_nas_id }}
{% endif -%}
{% if radius_nas_ip %}
nas-ip-address={{ radius_nas_ip }}
{% endif -%}
{% if radius_source_address %}
bind={{ radius_source_address }}
{% endif -%}


{% if radius_dynamic_author %}
dae-server={{ radius_dynamic_author.server }}:{{ radius_dynamic_author.port }},{{ radius_dynamic_author.key }}
{% endif -%}
{% endif %}
{% if ppp_gw %}
gw-ip-address={{ ppp_gw }}
{% endif %}

{% if sesscrtl != 'disable' %}
[common]
single-session={{ sesscrtl }}
{% endif %}

[ppp]
verbose=1
check-ip=1
{% if ppp_ccp %}
ccp=1
{% else %}
ccp=0
{% endif %}
{% if ppp_preallocate_vif %}
unit-preallocate=1
{% else %}
unit-preallocate=0
{% endif %}
{% if ppp_min_mtu %}
min-mtu={{ ppp_min_mtu }}
{% else %}
min-mtu={{ mtu }}
{% endif %}
{% if ppp_mru %}
mru={{ ppp_mru }}
{% endif %}
mppe={{ ppp_mppe }}
lcp-echo-interval={{ ppp_echo_interval }}
lcp-echo-timeout={{ ppp_echo_timeout }}
lcp-echo-failure={{ ppp_echo_failure }}
{% if ppp_ipv4 %}
ipv4={{ ppp_ipv4 }}
{% endif %}
{% if client_ipv6_pool %}
ipv6=allow
{% endif %}

{% if ppp_ipv6 %}
ipv6={{ ppp_ipv6 }}
{% if ppp_ipv6_intf_id %}
ipv6-intf-id={{ ppp_ipv6_intf_id }}
{% endif %}
{% if ppp_ipv6_peer_intf_id %}
ipv6-peer-intf-id={{ ppp_ipv6_peer_intf_id }}
{% endif %}
{% if ppp_ipv6_accept_peer_intf_id %}
ipv6-accept-peer-intf-id={{ ppp_ipv6_accept_peer_intf_id }}
{% endif %}
{% endif %}
mtu={{ mtu }}

[pppoe]
verbose=1
ac-name={{ concentrator }}

{% if interfaces %}
{% for interface in interfaces %}
interface={{ interface.name }}
{% if interface.vlans %}
vlan-mon={{ interface.name }},{{ interface.vlans | join(',') }}
interface=re:{{ interface.name }}\.\d+
{% endif %}
{% endfor -%}
{% endif -%}

{% if svc_name %}
service-name={{ svc_name|join(',') }}
{% endif -%}

{% if pado_delay %}
pado-delay={{ pado_delay }}
{% endif %}

{% if limits_burst or limits_connections or limits_connections %}
[connlimit]
{% if limits_connections %}
limit={{ limits_connections }}
{% endif %}
{% if limits_burst %}
burst={{ limits_burst }}
{% endif %}
{% if limits_timeout %}
timeout={{ limits_timeout }}
{% endif %}
{% endif %}

[cli]
tcp=127.0.0.1:2001
