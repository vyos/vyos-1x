### generated by accel_l2tp.py ###
[modules]
log_syslog
l2tp
chap-secrets
{% for proto in auth_proto: %}
{{proto}}
{% endfor%}

{% if auth_mode == 'radius' %}
radius
{% endif %}

ippool
shaper
ipv6pool
ipv6_nd
ipv6_dhcp

[core]
thread-count={{thread_cnt}}

[log]
syslog=accel-l2tp,daemon
copy=1
level=5

{% if dnsv4 %}
[dns]
{% for dns in dnsv4 %}
dns{{ loop.index }}={{ dns }}
{% endfor %}
{% endif %}

{% if dnsv6 %}
[ipv6-dns]
{% for dns in dnsv6 %}
{{ dns }}
{% endfor %}
{% endif %}

{% if wins %}
[wins]
{% for server in wins %}
wins{{ loop.index }}={{ server }}
{% endfor %}
{% endif %}

[l2tp]
verbose=1
ifname=l2tp%d
ppp-max-mtu={{ mtu }}
mppe={{ ppp_mppe }}
{% if outside_addr %}
bind={{ outside_addr }}
{% endif %}
{% if lns_shared_secret %}
secret={{ lns_shared_secret }}
{% endif %}
{% if lns_host_name %}
host-name={{ lns_host_name }}
{% endif %}

[client-ip-range]
0.0.0.0/0

{% if client_ip_pool or client_ip_subnets %}
[ip-pool]
{% if client_ip_pool %}
{{ client_ip_pool }}
{% endif %}
{% if client_ip_subnets %}
{% for sn in client_ip_subnets %}
{{sn}}
{% endfor %}
{% endif %}
{% endif %}
{% if gateway_address %}
gw-ip-address={{ gateway_address }}
{% endif %}

{% if auth_mode == 'local' %}
[chap-secrets]
chap-secrets={{ chap_secrets_file }}
{% elif auth_mode == 'radius' %}
[radius]
verbose=1
{% for r in radius_server %}
server={{ r.server }},{{ r.key }},auth-port={{ r.port }},acct-port={{ r.acct_port }},req-limit=0,fail-time={{ r.fail_time }}
{% endfor %}
{% if radius_dynamic_author.server is defined and radius_dynamic_author.server is not none %}
dae-server={{ radius_dynamic_author.server }}:{{ radius_dynamic_author.port }},{{ radius_dynamic_author.key }}
{% endif %}
{% if radius_acct_inter_jitter %}
acct-interim-jitter={{ radius_acct_inter_jitter }}
{% endif %}

acct-timeout={{ radius_acct_tmo }}
timeout={{ radius_timeout }}
max-try={{ radius_max_try }}

{% if radius_nas_id %}
nas-identifier={{ radius_nas_id }}
{% endif %}
{% if radius_nas_ip %}
nas-ip-address={{ radius_nas_ip }}
{% endif %}
{% if radius_source_address %}
bind={{ radius_source_address }}
{% endif %}
{% endif %}
{% if gateway_address %}
gw-ip-address={{ gateway_address }}
{% endif %}

[ppp]
verbose=1
check-ip=1
single-session=replace
lcp-echo-timeout={{ ppp_echo_timeout }}
lcp-echo-interval={{ ppp_echo_interval }}
lcp-echo-failure={{ ppp_echo_failure }}
{% if ccp_disable %}
ccp=0
{% endif %}
{% if client_ipv6_pool %}
ipv6=allow
{% endif %}


{% if client_ipv6_pool %}
[ipv6-pool]
{% for p in client_ipv6_pool %}
{{ p.prefix }},{{ p.mask }}
{% endfor %}
{% for p in client_ipv6_delegate_prefix %}
delegate={{ p.prefix }},{{ p.mask }}
{% endfor %}
{% endif %}

{% if client_ipv6_delegate_prefix %}
[ipv6-dhcp]
verbose=1
{% endif %}

{% if radius_shaper_attr %}
[shaper]
verbose=1
attr={{ radius_shaper_attr }}
{% if radius_shaper_vendor %}
vendor={{ radius_shaper_vendor }}
{% endif %}
{% endif %}

[cli]
tcp=127.0.0.1:2004
sessions-columns=ifname,username,calling-sid,ip,{{ ip6_column | join(',') }}{{ ',' if ip6_column }}rate-limit,type,comp,state,rx-bytes,tx-bytes,uptime
